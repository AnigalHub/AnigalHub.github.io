"use strict";(self["webpackChunktest_bis"]=self["webpackChunktest_bis"]||[]).push([[255],{5255:function(t,e,c){c.r(e),c.d(e,{default:function(){return A}});var n=function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("div",{staticClass:"pages"},[c("b-select",{attrs:{options:t.opDates},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}}),c("div",{staticClass:"nameTable"},[t._v("Счета с остатками на дату")]),c("b-table",{attrs:{"sticky-header":"",items:t.Accts,"select-mode":t.selectMode,selectable:"",fields:t.fields},on:{"row-selected":t.onRowSelected},scopedSlots:t._u([{key:"cell(Actions)",fn:function(e){var n=e.item;return[c("b-button",{staticClass:"mx-1",attrs:{variant:"primary"},on:{click:function(e){return t.onEditAcc(n)}}},[t._v("Редактировать")]),c("b-button",{staticClass:"mx-1",attrs:{variant:"danger"},on:{click:function(e){return t.onDeleteAcc(n)}}},[t._v("Удалить")])]}}])}),c("b-button",{attrs:{variant:"success"},on:{click:function(e){t.modalShow=!t.modalShow}}},[t._v("Создать")]),t.selectedAcc?c("div",{staticClass:"nameTable"},[t._v("Проводки")]):t._e(),t.selectedAcc?c("b-table",{attrs:{"sticky-header":"",items:t.operations,fields:t.fieldsOperations}}):t._e(),c("modal-set-account",{attrs:{"is-edit":t.edit,showModal:t.modalShow},on:{modalClosed:t.onModalClosed},model:{value:t.accToEdit,callback:function(e){t.accToEdit=e},expression:"accToEdit"}})],1)},a=[],o=c(8534),s=(c(1249),c(5666),function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("b-modal",{attrs:{"hide-footer":""},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[c("b-form",{on:{submit:function(e){return e.preventDefault(),t.onSetAcc.apply(null,arguments)}}},[c("b-input-group",{staticClass:"mb-2",attrs:{prepend:"Номер счета"}},[c("b-form-input",{attrs:{readonly:t.isEdit,state:t.stateAcctNum,type:"number",min:"1","aria-describedby":"inputFeedbackAcctNum"},model:{value:t.newAccount.AcctNum,callback:function(e){t.$set(t.newAccount,"AcctNum",e)},expression:"newAccount.AcctNum"}}),c("b-form-invalid-feedback",{attrs:{id:"inputFeedbackAcctNum"}},[t._v(" "+t._s(t.errorTextAcctNum)+" ")])],1),c("b-input-group",{staticClass:"mb-2",attrs:{prepend:"Остаток"}},[c("b-form-input",{attrs:{type:"number",state:t.stateBalance,"aria-describedby":"inputFeedbackBalance"},model:{value:t.newAccount.Balance,callback:function(e){t.$set(t.newAccount,"Balance",e)},expression:"newAccount.Balance"}}),c("b-form-invalid-feedback",{attrs:{id:"inputFeedbackBalance"}},[t._v(" "+t._s(t.errorTextBalance)+" ")])],1),c("b-input-group",{staticClass:"mb-2",attrs:{prepend:"Дата"}},[c("b-form-select",{attrs:{options:t.opDates,state:t.stateOpDate,disabled:t.isEdit,"aria-describedby":"inputFeedbackOpdate"},model:{value:t.newAccount.OpDate,callback:function(e){t.$set(t.newAccount,"OpDate",e)},expression:"newAccount.OpDate"}}),c("b-form-invalid-feedback",{attrs:{id:"inputFeedbackOpDate"}},[t._v(" "+t._s(t.errorTextOpDate)+" ")])],1),c("b-button",{staticClass:"mt-2 w-100",attrs:{type:"submit",variant:"success"}},[t._v("Сохранить")])],1)],1)}),i=[],r=(c(8862),{name:"modalSetAccount",data:function(){return{modalShow:!1,errorTextAcctNum:"",errorTextBalance:"",errorTextOpDate:"",newAccount:{AcctNum:"",Balance:"",OpDate:""}}},props:{value:Object,showModal:Boolean,isEdit:{type:Boolean,default:!1}},methods:{onSetAcc:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,""===this.newAccount.AcctNum||""===this.newAccount.Balance||""===this.newAccount.OpDate){t.next=10;break}return t.next=4,this.$store.dispatch("acctPos/setAccount",{old:this.value,new:this.newAccount});case 4:this.newAccount.AcctNum="",this.newAccount.Balance="",this.newAccount.OpDate="",this.modalShow=!1,t.next=13;break;case 10:this.newAccount.AcctNum||(this.newAccount.AcctNum=void 0),this.newAccount.Balance||(this.newAccount.Balance=void 0),this.newAccount.OpDate||(this.newAccount.OpDate=void 0);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),console.log("произошла ошибка");case 18:case"end":return t.stop()}}),t,this,[[0,15]])})));function e(){return t.apply(this,arguments)}return e}()},computed:{stateOpDate:function(){return void 0===this.newAccount.OpDate?(this.errorTextOpDate="Не введена дата",!1):!!this.newAccount.OpDate||void 0},stateAcctNum:function(){return void 0===this.newAccount.AcctNum?(this.errorTextAcctNum="Не введен номер счета",!1):!!this.newAccount.AcctNum||void 0},stateBalance:function(){return void 0===this.newAccount.Balance?(this.errorTextBalance="Не введен остаток",!1):!!this.newAccount.Balance||void 0},opDates:function(){var t=this.$store.getters["opDate/OpDates"];return t?t.map((function(t){return{text:t.OpDate,value:t.OpDate}})):null}},watch:{showModal:function(t){this.modalShow=t},value:function(t){if(t){var e=JSON.parse(JSON.stringify(t));this.newAccount=e}else this.newAccount={AcctNum:"",Balance:"",OpDate:""}},modalShow:function(t){t||this.$emit("modalClosed")}}}),u=r,l=c(3736),d=(0,l.Z)(u,s,i,!1,null,"7aec525c",null),p=d.exports,h={name:"account",components:{ModalSetAccount:p},data:function(){return{modalShow:!1,selectedDate:null,selectedAcc:null,accToEdit:null,edit:!1,acctPoss:null,operations:null,fields:[{key:"AcctNum",label:"Номер счета"},{key:"Balance",label:"Остаток"},{key:"Actions",label:"Действия"}],fieldsOperations:[{key:"OpDate",label:"Дата операционного дня"},{key:"AcctNumCr",label:"Счет дебета"},{key:"AcctNumDB",label:"Счет кредита"},{key:"Amount",label:"Сумма"}],selectMode:"single"}},methods:{onModalClosed:function(){this.edit=!1,this.modalShow=!1,this.accToEdit=null},onEditAcc:function(t){this.edit=!0,this.modalShow=!this.modalShow,this.accToEdit=t},onDeleteAcc:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("acctPos/deleteAccount",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onRowSelected:function(t){t.length<=0?this.selectedAcc=null:this.selectedAcc=t[0]},filterAcctPosByDate:function(t,e){var c=[];for(var n in t)e===t[n].OpDate&&c.push(t[n]);return c}},computed:{opDates:function(){var t=this.$store.getters["opDate/OpDates"];return t?(null==this.selectedDate&&(this.selectedDate=this.$store.getters["opDate/LastOpDate"]),t.map((function(t){return{text:t.OpDate,value:t.OpDate}}))):null},Accts:function(){var t=this.$store.getters["acctPos/AcctPos"];return this.filterAcctPosByDate(t,this.selectedDate)}},watch:{selectedAcc:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}return t.next=3,this.$store.dispatch("operations/filterByAccountAndDate",{account:e.AcctNum,date:this.selectedDate});case 3:this.operations=t.sent;case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},m=h,f=(0,l.Z)(m,n,a,!1,null,null,null),A=f.exports},1249:function(t,e,c){var n=c(2109),a=c(2092).map,o=c(1194),s=o("map");n({target:"Array",proto:!0,forced:!s},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=255-legacy.ee98be8e.js.map