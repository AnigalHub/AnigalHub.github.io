"use strict";(self["webpackChunktest_bis"]=self["webpackChunktest_bis"]||[]).push([[255],{255:function(t,e,c){c.r(e),c.d(e,{default:function(){return A}});var a=function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("div",{staticClass:"pages"},[c("b-select",{attrs:{options:t.opDates},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}}),c("div",{staticClass:"nameTable"},[t._v("Счета с остатками на дату")]),c("b-table",{attrs:{"sticky-header":"",items:t.Accts,"select-mode":t.selectMode,selectable:"",fields:t.fields},on:{"row-selected":t.onRowSelected},scopedSlots:t._u([{key:"cell(Actions)",fn:function(e){var a=e.item;return[c("b-button",{staticClass:"mx-1",attrs:{variant:"primary"},on:{click:function(e){return t.onEditAcc(a)}}},[t._v("Редактировать")]),c("b-button",{staticClass:"mx-1",attrs:{variant:"danger"},on:{click:function(e){return t.onDeleteAcc(a)}}},[t._v("Удалить")])]}}])}),c("b-button",{attrs:{variant:"success"},on:{click:function(e){t.modalShow=!t.modalShow}}},[t._v("Создать")]),t.selectedAcc?c("div",{staticClass:"nameTable"},[t._v("Проводки")]):t._e(),t.selectedAcc?c("b-table",{attrs:{"sticky-header":"",items:t.operations,fields:t.fieldsOperations}}):t._e(),c("modal-set-account",{attrs:{"is-edit":t.edit,showModal:t.modalShow},on:{modalClosed:t.onModalClosed},model:{value:t.accToEdit,callback:function(e){t.accToEdit=e},expression:"accToEdit"}})],1)},n=[],s=function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("b-modal",{attrs:{"hide-footer":""},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[c("b-form",{on:{submit:function(e){return e.preventDefault(),t.onSetAcc.apply(null,arguments)}}},[c("b-input-group",{staticClass:"mb-2",attrs:{prepend:"Номер счета"}},[c("b-form-input",{attrs:{readonly:t.isEdit,state:t.stateAcctNum,type:"number",min:"1","aria-describedby":"inputFeedbackAcctNum"},model:{value:t.newAccount.AcctNum,callback:function(e){t.$set(t.newAccount,"AcctNum",e)},expression:"newAccount.AcctNum"}}),c("b-form-invalid-feedback",{attrs:{id:"inputFeedbackAcctNum"}},[t._v(" "+t._s(t.errorTextAcctNum)+" ")])],1),c("b-input-group",{staticClass:"mb-2",attrs:{prepend:"Остаток"}},[c("b-form-input",{attrs:{type:"number",state:t.stateBalance,"aria-describedby":"inputFeedbackBalance"},model:{value:t.newAccount.Balance,callback:function(e){t.$set(t.newAccount,"Balance",e)},expression:"newAccount.Balance"}}),c("b-form-invalid-feedback",{attrs:{id:"inputFeedbackBalance"}},[t._v(" "+t._s(t.errorTextBalance)+" ")])],1),c("b-input-group",{staticClass:"mb-2",attrs:{prepend:"Дата"}},[c("b-form-select",{attrs:{options:t.opDates,state:t.stateOpDate,disabled:t.isEdit,"aria-describedby":"inputFeedbackOpdate"},model:{value:t.newAccount.OpDate,callback:function(e){t.$set(t.newAccount,"OpDate",e)},expression:"newAccount.OpDate"}}),c("b-form-invalid-feedback",{attrs:{id:"inputFeedbackOpDate"}},[t._v(" "+t._s(t.errorTextOpDate)+" ")])],1),c("b-button",{staticClass:"mt-2 w-100",attrs:{type:"submit",variant:"success"}},[t._v("Сохранить")])],1)],1)},o=[],i={name:"modalSetAccount",data(){return{modalShow:!1,errorTextAcctNum:"",errorTextBalance:"",errorTextOpDate:"",newAccount:{AcctNum:"",Balance:"",OpDate:""}}},props:{value:Object,showModal:Boolean,isEdit:{type:Boolean,default:!1}},methods:{onSetAcc:async function(){try{""!==this.newAccount.AcctNum&&""!==this.newAccount.Balance&&""!==this.newAccount.OpDate?(await this.$store.dispatch("acctPos/setAccount",{old:this.value,new:this.newAccount}),this.newAccount.AcctNum="",this.newAccount.Balance="",this.newAccount.OpDate="",this.modalShow=!1):(this.newAccount.AcctNum||(this.newAccount.AcctNum=void 0),this.newAccount.Balance||(this.newAccount.Balance=void 0),this.newAccount.OpDate||(this.newAccount.OpDate=void 0))}catch(t){console.log("произошла ошибка")}}},computed:{stateOpDate(){return void 0===this.newAccount.OpDate?(this.errorTextOpDate="Не введена дата",!1):!!this.newAccount.OpDate||void 0},stateAcctNum(){return void 0===this.newAccount.AcctNum?(this.errorTextAcctNum="Не введен номер счета",!1):!!this.newAccount.AcctNum||void 0},stateBalance(){return void 0===this.newAccount.Balance?(this.errorTextBalance="Не введен остаток",!1):!!this.newAccount.Balance||void 0},opDates:function(){const t=this.$store.getters["opDate/OpDates"];return t?t.map((t=>({text:t.OpDate,value:t.OpDate}))):null}},watch:{showModal:function(t){this.modalShow=t},value:function(t){if(t){const e=JSON.parse(JSON.stringify(t));this.newAccount=e}else this.newAccount={AcctNum:"",Balance:"",OpDate:""}},modalShow:function(t){t||this.$emit("modalClosed")}}},l=i,u=c(736),r=(0,u.Z)(l,s,o,!1,null,"7aec525c",null),d=r.exports,p={name:"account",components:{ModalSetAccount:d},data(){return{modalShow:!1,selectedDate:null,selectedAcc:null,accToEdit:null,edit:!1,acctPoss:null,operations:null,fields:[{key:"AcctNum",label:"Номер счета"},{key:"Balance",label:"Остаток"},{key:"Actions",label:"Действия"}],fieldsOperations:[{key:"OpDate",label:"Дата операционного дня"},{key:"AcctNumCr",label:"Счет дебета"},{key:"AcctNumDB",label:"Счет кредита"},{key:"Amount",label:"Сумма"}],selectMode:"single"}},methods:{onModalClosed:function(){this.edit=!1,this.modalShow=!1,this.accToEdit=null},onEditAcc:function(t){this.edit=!0,this.modalShow=!this.modalShow,this.accToEdit=t},onDeleteAcc:async function(t){await this.$store.dispatch("acctPos/deleteAccount",t)},onRowSelected:function(t){t.length<=0?this.selectedAcc=null:this.selectedAcc=t[0]},filterAcctPosByDate(t,e){let c=[];for(let a in t)e===t[a].OpDate&&c.push(t[a]);return c}},computed:{opDates:function(){const t=this.$store.getters["opDate/OpDates"];return t?(null==this.selectedDate&&(this.selectedDate=this.$store.getters["opDate/LastOpDate"]),t.map((t=>({text:t.OpDate,value:t.OpDate})))):null},Accts:function(){let t=this.$store.getters["acctPos/AcctPos"];return this.filterAcctPosByDate(t,this.selectedDate)}},watch:{selectedAcc:async function(t){t&&(this.operations=await this.$store.dispatch("operations/filterByAccountAndDate",{account:t.AcctNum,date:this.selectedDate}))}}},h=p,m=(0,u.Z)(h,a,n,!1,null,null,null),A=m.exports}}]);
//# sourceMappingURL=255.7edaf3a5.js.map